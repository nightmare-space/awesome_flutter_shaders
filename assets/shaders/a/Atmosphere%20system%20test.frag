{
  "sksl": {
    "entrypoint": "Atmospheresystemtest_fragment_main",
    "shader": "// This SkSL shader is autogenerated by spirv-cross.\n\nfloat4 flutter_FragCoord;\n\nstruct ray_t\n{\n    vec3 origin;\n    vec3 direction;\n};\n\nstruct sphere_t\n{\n    vec3 origin;\n    float radius;\n    int material;\n};\n\n\nuniform vec2 iResolution;\nuniform float iTime;\nuniform float iFrame;\nuniform vec4 iMouse;\nuniform vec4 iChannelWrap;\nuniform vec4 iChannelFilter;\nuniform vec2 iChannelResolution0;\nuniform vec2 iChannelResolution1;\nuniform vec2 iChannelResolution2;\nuniform vec2 iChannelResolution3;\n\nvec4 fragColor;\n\nvec3 sun_dir;\n\nvec2 FLT_flutter_local_FlutterFragCoord()\n{\n    return flutter_FragCoord.xy;\n}\n\nmat3 FLT_flutter_local_rotate_around_x(float angle_degrees)\n{\n    float angle = radians(angle_degrees);\n    float _sin = sin(angle);\n    float _cos = cos(angle);\n    return mat3(vec3(1.0, 0.0, 0.0), vec3(0.0, _cos, -_sin), vec3(0.0, _sin, _cos));\n}\n\nbool FLT_flutter_local_isect_sphere(ray_t ray, sphere_t sphere, inout float t0, inout float t1)\n{\n    vec3 rc = sphere.origin - ray.origin;\n    float radius2 = sphere.radius * sphere.radius;\n    float tca = dot(rc, ray.direction);\n    float d2 = dot(rc, rc) - (tca * tca);\n    if (d2 > radius2)\n    {\n        return false;\n    }\n    float thc = sqrt(radius2 - d2);\n    t0 = tca - thc;\n    t1 = tca + thc;\n    return true;\n}\n\nfloat FLT_flutter_local_rayleigh_phase_func(float mu)\n{\n    return (3.0 * (1.0 + (mu * mu))) / 50.265483856201171875;\n}\n\nfloat FLT_flutter_local_henyey_greenstein_phase_func(float mu)\n{\n    return 0.422399997711181640625 / (12.56637096405029296875 * pow(1.577600002288818359375 - (1.519999980926513671875 * mu), 1.5));\n}\n\nbool FLT_flutter_local_get_sun_light(ray_t ray, inout float optical_depthR, inout float optical_depthM)\n{\n    float t0;\n    float param = t0;\n    float t1;\n    float param_1 = t1;\n    bool _204 = FLT_flutter_local_isect_sphere(ray, sphere_t(vec3(0.0), 6420000.0, 0), param, param_1);\n    t0 = param;\n    t1 = param_1;\n    float march_pos = 0.0;\n    float march_step = t1 / 8.0;\n    for (int i = 0; i < 8; i++)\n    {\n        vec3 s = ray.origin + (ray.direction * (march_pos + (0.5 * march_step)));\n        float height = length(s) - 6360000.0;\n        if (height < 0.0)\n        {\n            return false;\n        }\n        optical_depthR += (exp((-height) / 7994.0) * march_step);\n        optical_depthM += (exp((-height) / 1200.0) * march_step);\n        march_pos += march_step;\n    }\n    return true;\n}\n\nvec3 FLT_flutter_local_get_incident_light(ray_t ray, vec3 sun)\n{\n    float t0;\n    float param = t0;\n    float t1;\n    float param_1 = t1;\n    bool _273 = FLT_flutter_local_isect_sphere(ray, sphere_t(vec3(0.0), 6420000.0, 0), param, param_1);\n    t0 = param;\n    t1 = param_1;\n    if (!_273)\n    {\n        return vec3(0.0);\n    }\n    float march_step = t1 / 16.0;\n    float mu = dot(ray.direction, sun);\n    float param_2 = mu;\n    float phaseR = FLT_flutter_local_rayleigh_phase_func(param_2);\n    float param_3 = mu;\n    float phaseM = FLT_flutter_local_henyey_greenstein_phase_func(param_3);\n    float optical_depthR = 0.0;\n    float optical_depthM = 0.0;\n    vec3 sumR = vec3(0.0);\n    vec3 sumM = vec3(0.0);\n    float march_pos = 0.0;\n    for (int i = 0; i < 16; i++)\n    {\n        vec3 s = ray.origin + (ray.direction * (march_pos + (0.5 * march_step)));\n        float height = length(s) - 6360000.0;\n        float hr = exp((-height) / 7994.0) * march_step;\n        float hm = exp((-height) / 1200.0) * march_step;\n        optical_depthR += hr;\n        optical_depthM += hm;\n        ray_t light_ray = ray_t(s, sun);\n        float optical_depth_lightR = 0.0;\n        float optical_depth_lightM = 0.0;\n        float param_4 = optical_depth_lightR;\n        float param_5 = optical_depth_lightM;\n        bool _356 = FLT_flutter_local_get_sun_light(light_ray, param_4, param_5);\n        optical_depth_lightR = param_4;\n        optical_depth_lightM = param_5;\n        bool overground = _356;\n        if (overground)\n        {\n            vec3 tau = (vec3(5.5000000429572537541389465332031e-06, 1.2999999853491317480802536010742e-05, 2.2399999579647555947303771972656e-05) * (optical_depthR + optical_depth_lightR)) + (vec3(2.3099999452824704349040985107422e-05) * (optical_depthM + optical_depth_lightM));\n            vec3 attenuation = exp(-tau);\n            sumR += (attenuation * hr);\n            sumM += (attenuation * hm);\n        }\n        march_pos += march_step;\n    }\n    return (((sumR * phaseR) * vec3(5.5000000429572537541389465332031e-06, 1.2999999853491317480802536010742e-05, 2.2399999579647555947303771972656e-05)) + ((sumM * phaseM) * vec3(2.0999999833293259143829345703125e-05))) * 20.0;\n}\n\nray_t FLT_flutter_local_get_primary_ray(vec3 cam_local_point, vec3 cam_origin, vec3 cam_look_at)\n{\n    vec3 fwd = normalize(cam_look_at - cam_origin);\n    vec3 up = vec3(0.0, 1.0, 0.0);\n    vec3 right = cross(up, fwd);\n    up = cross(fwd, right);\n    ray_t r = ray_t(cam_origin, normalize((fwd + (up * cam_local_point.y)) + (right * cam_local_point.x)));\n    return r;\n}\n\nvoid FLT_flutter_local_mainImage(out vec4 fragColor_1, vec2 fragCoord)\n{\n    vec2 aspect_ratio = vec2(iResolution.x / iResolution.y, 1.0);\n    float fov = 1.0;\n    vec2 point_ndc = fragCoord / iResolution;\n    vec3 point_cam = vec3((((point_ndc * 2.0) - vec2(1.0)) * aspect_ratio) * fov, -1.0);\n    vec3 col = vec3(0.0);\n    mat3 rot = FLT_flutter_local_rotate_around_x((-abs(sin(iTime / 2.0))) * 90.0);\n    vec3 sun = rot * sun_dir;\n    if (iMouse.z < 0.100000001490116119384765625)\n    {\n        vec3 p = point_cam;\n        float z2 = (p.x * p.x) + (p.y * p.y);\n        float phi = atan(p.y, p.x);\n        float theta = acos(1.0 - z2);\n        vec3 dir = vec3(sin(theta) * cos(phi), cos(theta), sin(theta) * sin(phi));\n        ray_t ray = ray_t(vec3(0.0, 6360001.0, 0.0), dir);\n        vec3 param = sun;\n        col = FLT_flutter_local_get_incident_light(ray, param);\n    }\n    else\n    {\n        vec3 eye = vec3(0.0, 6360001.0, 0.0);\n        vec3 look_at = vec3(0.0, 6360001.5, -1.0);\n        vec3 param_1 = eye;\n        vec3 param_2 = look_at;\n        eye = param_1;\n        look_at = param_2;\n        ray_t ray_1 = FLT_flutter_local_get_primary_ray(point_cam, param_1, param_2);\n        if (dot(ray_1.direction, vec3(0.0, 1.0, 0.0)) > 0.0)\n        {\n            vec3 param_3 = sun;\n            col = FLT_flutter_local_get_incident_light(ray_1, param_3);\n        }\n        else\n        {\n            col = vec3(0.333000004291534423828125);\n        }\n    }\n    fragColor_1 = vec4(col, 1.0);\n}\n\nvoid FLT_main()\n{\n    sun_dir = vec3(0.0, 1.0, 0.0);\n    float keep = (((((((((((iFrame + iMouse.x) + iTime) + iResolution.x) + iChannelWrap.x) + iChannelResolution0.x) + iChannelResolution0.y) + iChannelResolution1.x) + iChannelResolution1.y) + iChannelResolution2.x) + iChannelResolution2.y) + iChannelResolution3.x) + iChannelResolution3.y;\n    vec2 fragCoord_1 = FLT_flutter_local_FlutterFragCoord();\n    vec2 param_5 = fragCoord_1;\n    vec4 param_4;\n    FLT_flutter_local_mainImage(param_4, param_5);\n    fragColor = param_4;\n    if (keep < (-100000002004087734272.0))\n    {\n        fragColor += vec4(keep);\n    }\n}\n\nhalf4 main(float2 iFragCoord)\n{\n      flutter_FragCoord = float4(iFragCoord, 0, 0);\n      FLT_main();\n      return fragColor;\n}\n",
    "stage": 1,
    "uniforms": [
      {
        "array_elements": 0,
        "bit_width": 32,
        "columns": 1,
        "location": 0,
        "name": "iResolution",
        "rows": 2,
        "type": 10
      },
      {
        "array_elements": 0,
        "bit_width": 32,
        "columns": 1,
        "location": 1,
        "name": "iTime",
        "rows": 1,
        "type": 10
      },
      {
        "array_elements": 0,
        "bit_width": 32,
        "columns": 1,
        "location": 2,
        "name": "iFrame",
        "rows": 1,
        "type": 10
      },
      {
        "array_elements": 0,
        "bit_width": 32,
        "columns": 1,
        "location": 3,
        "name": "iMouse",
        "rows": 4,
        "type": 10
      },
      {
        "array_elements": 0,
        "bit_width": 32,
        "columns": 1,
        "location": 4,
        "name": "iChannelWrap",
        "rows": 4,
        "type": 10
      },
      {
        "array_elements": 0,
        "bit_width": 32,
        "columns": 1,
        "location": 5,
        "name": "iChannelFilter",
        "rows": 4,
        "type": 10
      },
      {
        "array_elements": 0,
        "bit_width": 32,
        "columns": 1,
        "location": 6,
        "name": "iChannelResolution0",
        "rows": 2,
        "type": 10
      },
      {
        "array_elements": 0,
        "bit_width": 32,
        "columns": 1,
        "location": 7,
        "name": "iChannelResolution1",
        "rows": 2,
        "type": 10
      },
      {
        "array_elements": 0,
        "bit_width": 32,
        "columns": 1,
        "location": 8,
        "name": "iChannelResolution2",
        "rows": 2,
        "type": 10
      },
      {
        "array_elements": 0,
        "bit_width": 32,
        "columns": 1,
        "location": 9,
        "name": "iChannelResolution3",
        "rows": 2,
        "type": 10
      }
    ]
  }
}